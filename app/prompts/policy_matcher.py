"""
Policy Matcher Prompts
مطابقة نص السياسة مع النوع المحدد
"""

def get_policy_matcher_prompt(policy_type: str, policy_text: str) -> str:
    """
    إنشاء Prompt للتحقق من مطابقة نص السياسة مع النوع المحدد
    """
    
    policy_indicators = {
        "سياسات الاسترجاع و الاستبدال": {
            "keywords": [
                "إرجاع", "استرجاع", "استبدال", "فسخ العقد", "رد المنتج",
                "7 أيام", "مدة الإرجاع", "شروط الإرجاع", "عيوب",
                "الفاتورة", "الحالة الأصلية", "استخدام المنتج"
            ],
            "topics": [
                "حق العميل في إرجاع المنتجات",
                "المدة الزمنية للإرجاع",
                "شروط قبول الإرجاع",
                "استثناءات المنتجات غير القابلة للإرجاع",
                "عملية استبدال المنتجات"
            ]
        },
        "سياسة الحساب و الخصوصية": {
            "keywords": [
                "البيانات الشخصية", "الخصوصية", "جمع البيانات", "حماية البيانات",
                "حذف الحساب", "تعديل البيانات", "التشفير", "الأمان",
                "الحق في النسيان", "مشاركة البيانات", "أطراف ثالثة"
            ],
            "topics": [
                "أنواع البيانات المجمعة",
                "الغرض من جمع البيانات",
                "حقوق المستخدم في بياناته",
                "إجراءات حماية وأمن البيانات",
                "سياسة حذف البيانات"
            ]
        },
        "سياسة الشحن و التوصيل": {
            "keywords": [
                "الشحن", "التوصيل", "مدة التوصيل", "تأخير", "شركة الشحن",
                "رسوم الشحن", "المناطق", "التسليم", "تتبع الطلب",
                "15 يوماً", "القوة القاهرة"
            ],
            "topics": [
                "مدة التوصيل المتوقعة",
                "تكلفة الشحن",
                "المناطق المشمولة بالتوصيل",
                "التعامل مع تأخير التوصيل",
                "مسؤولية المتجر عن الشحنة"
            ]
        }
    }
    
    indicators = policy_indicators.get(policy_type, {})
    
    prompt = f"""أنت خبير في تحليل السياسات القانونية للمتاجر الإلكترونية.

المهمة: تحديد ما إذا كان النص المقدم يطابق نوع السياسة المحدد.

نوع السياسة المطلوب: {policy_type}

الكلمات والمواضيع المتوقعة في هذا النوع:
- الكلمات المفتاحية: {', '.join(indicators.get('keywords', []))}
- المواضيع: {', '.join(indicators.get('topics', []))}

النص المقدم:
{policy_text}

قم بتحليل النص وحدد:
1. هل يتحدث النص فعلاً عن "{policy_type}"؟
2. ما نسبة التطابق (0-100)؟
3. إذا كان غير مطابق، ما هو نوع السياسة الفعلي الذي يتحدث عنه النص؟

أجب بصيغة JSON فقط:
{{
    "is_matched": true/false,
    "confidence": عدد من 0 إلى 100,
    "reason": "السبب التفصيلي",
    "detected_policy_type": "نوع السياسة الفعلي إذا كان مختلفاً"
}}
"""
    
    return prompt