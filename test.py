import asyncio
import aiohttp
import json
import time

API_URL = "http://localhost:8000/api/analyze"

dummy_requests = [

    # =========================
    # ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู
    # =========================
    {
        "policy_text": """
ูููู ููุนููู ุทูุจ ุฅุฑุฌุงุน ุฃู ุงุณุชุจุฏุงู ุงูููุชุฌ ุฎูุงู 10 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุงุณุชูุงูุ
ุจุดุฑุท ุชูุฏูู ุฅุซุจุงุช ุงูุดุฑุงุก ูุฃู ูููู ุงูููุชุฌ ุบูุฑ ูุณุชุฎุฏู ูุจุญุงูุชู ุงูุฃุตููุฉ.
ูุง ูุชู ูุจูู ุฅุฑุฌุงุน ูุณุชุญุถุฑุงุช ุงูุนูุงูุฉ ุงูุดุฎุตูุฉ ุฃู ุงูููุชุฌุงุช ุงูุชู ุชู ูุชุญูุง.
ูู ุญุงู ุงูููุงููุฉ ุนูู ุงูุฅุฑุฌุงุนุ ูุชู ุฑุฏ ุงููุจูุบ ุฎูุงู 7 ุฃูุงู ุนูู.
""",
        "policy_type": "ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู",
        "shop_name": "Urban Style",
        "shop_specialization": "ููุงุจุณ ุดุจุงุจูุฉ"
    },
    {
        "policy_text": """
ูุณูุญ ุงููุชุฌุฑ ุจุงุณุชุจุฏุงู ุงูููุงุณุงุช ููุท ุฎูุงู 5 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู.
ูุง ูููู ุงุณุชุฑุฌุงุน ุงูููุชุฌุงุช ุฅูุง ูู ุญุงูุฉ ูุฌูุฏ ุนูุจ ุชุตููุน ูุซุจุช.
ูุชุญูู ุงูุนููู ุชูุงููู ุงูุดุญู ูู ุฌููุน ุญุงูุงุช ุงูุงุณุชุจุฏุงู.
""",
        "policy_type": "ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู",
        "shop_name": "Classic Wear",
        "shop_specialization": "ุฃุฒูุงุก ุฑุณููุฉ"
    },
    {
        "policy_text": """
ุงูููุชุฌุงุช ุงูุชู ูุชู ุดุฑุงุคูุง ุถูู ุงูุนุฑูุถ ุงููุญุฏูุฏุฉ ุฃู ุงูุชุตููุงุช ุงูููุงุฆูุฉ
ุบูุฑ ูุงุจูุฉ ููุฅุฑุฌุงุน ุฃู ุงูุงุณุชุจุฏุงู ุฅูุง ูู ุญุงู ุงุณุชูุงู ููุชุฌ ุชุงูู.
ูุฌุจ ุงูุฅุจูุงุบ ุฎูุงู 48 ุณุงุนุฉ ูู ุงูุงุณุชูุงู.
""",
        "policy_type": "ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู",
        "shop_name": "Outlet Hub",
        "shop_specialization": "ุชุตููุฉ ููุชุฌุงุช"
    },

    # =========================
    # ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ
    # =========================
    {
        "policy_text": """
ูุชุทูุจ ุงุณุชุฎุฏุงู ุงููุชุฌุฑ ุฅูุดุงุก ุญุณุงุจ ุดุฎุตู ูุชุถูู ุจูุงูุงุช ุตุญูุญุฉ ููุญุฏุซุฉ.
ููุชุฒู ุงููุชุฌุฑ ุจุญูุงูุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ูุนุฏู ุจูุนูุง ุฃู ูุดุงุฑูุชูุง ูุฃุบุฑุงุถ ุชุณููููุฉ.
ูุฏ ูุชู ุชุนููู ุงูุญุณุงุจ ูุคูุชูุง ูู ุญุงู ุงูุงุดุชุจุงู ูู ุฃูุดุทุฉ ูุฎุงููุฉ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ",
        "shop_name": "ShopSphere",
        "shop_specialization": "ููุตุฉ ุชุฌุงุฑุฉ ุฅููุชุฑูููุฉ"
    },
    {
        "policy_text": """
ูููู ุงููุชุฌุฑ ุจุฌูุน ุจูุงูุงุช ุงูุงุณุชุฎุฏุงู ูุชุญุณูู ุชุฌุฑุจุฉ ุงูุนููุงุก ูุชุญููู ุงูุฃุฏุงุก.
ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ููู ูุนุงููุฑ ุฃูู ูุนูููุงุช ูุนุชูุฏุฉ.
ูุญู ูููุณุชุฎุฏู ุชุนุฏูู ุฃู ุญุฐู ุจูุงูุงุชู ุงูุดุฎุตูุฉ ูู ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ",
        "shop_name": "NextBuy",
        "shop_specialization": "ุชุณูู ุฐูู"
    },
    {
        "policy_text": """
ูุง ูุณูุญ ุจุฅูุดุงุก ุฃูุซุฑ ูู ุญุณุงุจ ูููุณ ุงููุณุชุฎุฏู.
ุฃู ุฅุณุงุกุฉ ุงุณุชุฎุฏุงู ูุฏ ุชุคุฏู ุฅูู ุฅุบูุงู ุงูุญุณุงุจ ููุงุฆููุง ุฏูู ุฅุดุนุงุฑ ูุณุจู.
ูุฎุถุน ุงุณุชุฎุฏุงู ุงููููุน ูุฌููุน ุงูููุงููู ูุงูููุงุฆุญ ุงููุนููู ุจูุง.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ",
        "shop_name": "SecureMall",
        "shop_specialization": "ุชุฌุงุฑุฉ ุขููุฉ"
    },

    # =========================
    # ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู
    # =========================
    {
        "policy_text": """
ูุชู ุชุฌููุฒ ุงูุทูุจุงุช ุฎูุงู 24 ุฅูู 48 ุณุงุนุฉ ูู ุชุฃููุฏ ุงูุฏูุน.
ูุชู ุงูุชูุตูู ุฏุงุฎู ุงููุฏู ุงูุฑุฆูุณูุฉ ุฎูุงู 3 ุฃูุงู ุนูู.
ูุฏ ุชุฎุชูู ุงููุฏุฉ ุญุณุจ ุชููุฑ ุงูููุชุฌ ุฃู ุถุบุท ุงูุทูุจุงุช.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "QuickRoute",
        "shop_specialization": "ุดุญู ุณุฑูุน"
    },
    {
        "policy_text": """
ุชุดูู ุฎุฏูุฉ ุงูุชูุตูู ุฌููุน ุงููุญุงูุธุงุช ูุน ุงุณุชุซูุงุก ุจุนุถ ุงูููุงุทู ุงููุงุฆูุฉ.
ูุฏ ูุชู ูุฑุถ ุฑุณูู ุฅุถุงููุฉ ุญุณุจ ูููุน ุงูุชุณููู.
ูุชุญูู ุงูุนููู ูุณุคูููุฉ ุงุณุชูุงู ุงูุทูุจ ูู ุงูููุนุฏ ุงููุญุฏุฏ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "NationShip",
        "shop_specialization": "ุดุญู ุฏุงุฎูู"
    },
    {
        "policy_text": """
ูู ุญุงู ุชุนุฐุฑ ุชุณููู ุงูุทูุจ ุจุนุฏ ูุญุงููุชููุ
ูุชู ุฅูุบุงุก ุงูุทูุจ ุชููุงุฆููุง ูุฅุนุงุฏุฉ ุงูุดุญูุฉ ุฅูู ุงููุณุชูุฏุน.
ูุชู ุฎุตู ุชูุงููู ุงูุดุญู ูู ุงููุจูุบ ุงููุณุชุฑุฏ ุฅู ูุฌุฏ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "Door2Door",
        "shop_specialization": "ุชูุตูู ููุฒูู"
    },
    {
        "policy_text": """
ูุฌุจ ูุญุต ุงูุดุญูุฉ ุนูุฏ ุงูุงุณุชูุงู ูุงูุชุฃูุฏ ูู ุณูุงูุชูุง.
ุฃู ููุงุญุธุงุช ุจุนุฏ ุงูุงุณุชูุงู ูุง ุชููู ูุดูููุฉ ุจุณูุงุณุฉ ุงูุชุนููุถ.
ูุฑุฌู ุงูุชูุงุตู ูุน ุงูุฏุนู ุฎูุงู 12 ุณุงุนุฉ ููุท.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "SafeDrop",
        "shop_specialization": "ุชูุตูู ุขูู"
    }
]


# ุฏุงูุฉ ูุฅุฑุณุงู ุงูุทูุจ ุงููุงุญุฏ
async def send_request(session, payload, index):
    print(f"๐ Sending request #{index}")
    try:
        async with session.post(API_URL, json=payload, timeout=15) as response:
            status = response.status
            # ูุฑุงุกุฉ ุงูุฑุฏ ูู JSON
            try:
                result = await response.json()
                print(f"โ Response #{index} [Status: {status}]: {json.dumps(result, ensure_ascii=False, indent=2)}")
            except:
                text = await response.text()
                print(f"โ๏ธ Response #{index} [Status: {status}] (Raw): {text}")
    except Exception as e:
        print(f"โ Request #{index} failed: {e}")

async def main():
    # ุงุณุชุฎุฏุงู ClientSession ูุงุญุฏ ููู ุงูุทูุจุงุช ูุฒูุงุฏุฉ ุงูููุงุกุฉ
    async with aiohttp.ClientSession() as session:
        tasks = []
        
        for i, payload in enumerate(dummy_requests, start=1):
            # ุฅูุดุงุก Task ููู ุฑููููุณุช ุนุดุงู ูุดุชุบู ูู ุงูุฎูููุฉ
            task = asyncio.create_task(send_request(session, payload, i))
            tasks.append(task)
            
            # ุงููุงุตู ุงูุฒููู ุงููู ุทูุจุชู (10 ูููู ุซุงููุฉ = 0.01 ุซุงููุฉ)
            await asyncio.sleep(0.01)
        
        # ุงูุงูุชุธุงุฑ ูุญุฏ ูุง ูู ุงูุทูุจุงุช ุชุฎูุต ูุจู ูุง ูููู ุงูุจุฑูุงูุฌ
        await asyncio.gather(*tasks)

if __name__ == "__main__":
    start_time = time.perf_counter()
    
    # ุชุดุบูู ุงููุญุฑู ุงูุฎุงุต ุจู Async
    asyncio.run(main())
    
    end_time = time.perf_counter()
    print(f"\nโจ All requests finished in {end_time - start_time:.2f} seconds.")
