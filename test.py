import asyncio
import aiohttp
import json
import time

API_URL = "http://localhost:8000/api/analyze"

dummy_requests = [

    # =========================
    # ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู
    # =========================
    {
        "policy_text": """
ูุญู ููุนููู ุฅุฑุฌุงุน ุฃู ุงุณุชุจุฏุงู ุงูููุชุฌ ุฎูุงู ูุฏุฉ ูุง ุชุชุฌุงูุฒ 14 ููููุง ูู ุชุงุฑูุฎ ุงูุงุณุชูุงูุ
ุดุฑูุทุฉ ุฃู ูููู ุงูููุชุฌ ุบูุฑ ูุณุชุฎุฏู ูุจุญุงูุชู ุงูุฃุตููุฉ ูุน ุฌููุน ุงูููุญูุงุช.
ูุง ุชุดูู ูุฐู ุงูุณูุงุณุฉ ุงูููุชุฌุงุช ุงููุงุจูุฉ ููุงุณุชููุงู ุฃู ุงูุชู ุชู ูุชุญูุง.
ูุชุญูู ุงูุนููู ุชูุงููู ุงูุดุญู ูู ุญุงู ุนุฏู ูุฌูุฏ ุนูุจ ุชุตููุน.
""",
        "policy_type": "ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู",
        "shop_name": "Nova Wear",
        "shop_specialization": "ููุงุจุณ ุนุตุฑูุฉ"
    },
    {
        "policy_text": """
ูุณูุญ ุงููุชุฌุฑ ุจุงุณุชุจุฏุงู ุงูููุงุณุงุช ููุท ุฎูุงู 7 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู.
ูุง ูุชู ูุจูู ุทูุจุงุช ุงูุฅุฑุฌุงุน ุงูููุฏู ุฅูุง ูู ุญุงู ูุฌูุฏ ุฎูู ูุตูุนู ูุซุจุช.
ูุชู ูุญุต ุฌููุน ุงูุทูุจุงุช ูุจู ุงูููุงููุฉ ุงูููุงุฆูุฉ.
""",
        "policy_type": "ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู",
        "shop_name": "Gentlemen Club",
        "shop_specialization": "ุฃุฒูุงุก ุฑุฌุงููุฉ"
    },
    {
        "policy_text": """
ุงูููุชุฌุงุช ุงูุชู ูุชู ุดุฑุงุคูุง ุถูู ุงูุนุฑูุถ ุงูุชุฑููุฌูุฉ ุงูููุณููุฉ
ุบูุฑ ูุงุจูุฉ ููุฅุฑุฌุงุน ุฃู ุงูุงุณุชุจุฏุงู ุฅูุง ูู ุญุงู ุงุณุชูุงู ููุชุฌ ุชุงูู.
ูุฌุจ ุงูุฅุจูุงุบ ุฎูุงู 72 ุณุงุนุฉ ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู.
""",
        "policy_type": "ุณูุงุณุงุช ุงูุงุณุชุฑุฌุงุน ู ุงูุงุณุชุจุฏุงู",
        "shop_name": "Deal Square",
        "shop_specialization": "ุนุฑูุถ ูุชุฎููุถุงุช"
    },

    # =========================
    # ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ
    # =========================
    {
        "policy_text": """
ูุฌุจ ุนูู ุงููุณุชุฎุฏู ุฅูุดุงุก ุญุณุงุจ ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุตุญูุญุฉ ูุญุฏูุซุฉ.
ููุชุฒู ุงููุชุฌุฑ ุจุงูุญูุงุธ ุนูู ุณุฑูุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ูุนุฏู ูุดุงุฑูุชูุง ูุน ุฃู ุฌูุฉ ุบูุฑ ูุฎููุฉ.
ูุญู ูุฅุฏุงุฑุฉ ุงููุชุฌุฑ ุชุนููู ุงูุญุณุงุจ ูุคูุชูุง ูู ุญุงู ุงูุงุดุชุจุงู ูู ูุดุงุท ูุฎุงูู.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ",
        "shop_name": "BuyFlow",
        "shop_specialization": "ููุตุฉ ุชุฌุงุฑุฉ ุฅููุชุฑูููุฉ"
    },
    {
        "policy_text": """
ูููู ุงููุชุฌุฑ ุจุฌูุน ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุจูุงูุงุช ุงููุงุฒูุฉ ูุฅุชูุงู ุงูุทูุจุงุช ูุชุญุณูู ุงูุฎุฏูุฉ.
ูุง ูุชู ุชุฎุฒูู ุจูุงูุงุช ุจุทุงูุงุช ุงูุฏูุน ุนูู ุฎูุงุฏู ุงููุชุฌุฑ.
ูุญู ูููุณุชุฎุฏู ุทูุจ ุญุฐู ุญุณุงุจู ูุจูุงูุงุชู ูู ุฃู ููุช.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ",
        "shop_name": "CloudCart",
        "shop_specialization": "ุชุณูู ุฅููุชุฑููู"
    },
    {
        "policy_text": """
ูุญุธุฑ ุงุณุชุฎุฏุงู ุงูุญุณุงุจ ูุฃู ุฃุบุฑุงุถ ุบูุฑ ูุงููููุฉ ุฃู ูุณูุฆุฉ.
ูู ุญุงู ุซุจูุช ูุฎุงููุฉ ุงูุดุฑูุทุ ูุชู ุฅุบูุงู ุงูุญุณุงุจ ุฏูู ุฅุดุนุงุฑ ูุณุจู.
ูุฎุถุน ุงุณุชุฎุฏุงู ุงููููุน ููููุงููู ุงููุนููู ุจูุง.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุญุณุงุจ ู ุงูุฎุตูุตูุฉ",
        "shop_name": "TrustMarket",
        "shop_specialization": "ุชุฌุงุฑุฉ ููุซููุฉ"
    },

    # =========================
    # ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู
    # =========================
    {
        "policy_text": """
ูุชู ุชุฌููุฒ ุงูุทูุจุงุช ุฎูุงู ูุฏุฉ ุชุชุฑุงูุญ ูู 1 ุฅูู 3 ุฃูุงู ุนูู ุจุนุฏ ุชุฃููุฏ ุงูุฏูุน.
ูุฎุชูู ููุช ุงูุชูุตูู ุญุณุจ ูููุน ุงูุนููู ูุดุฑูุฉ ุงูุดุญู.
ุณูุชู ุฅุดุนุงุฑ ุงูุนููู ุจุฑูู ุงูุชุชุจุน ููุฑ ุดุญู ุงูุทูุจ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "SpeedWay",
        "shop_specialization": "ุชูุตูู ุณุฑูุน"
    },
    {
        "policy_text": """
ุชุดูู ุฎุฏูุฉ ุงูุชูุตูู ูุนุธู ุงููุฏู ุงูุฑุฆูุณูุฉุ
ููุฏ ูุชู ูุฑุถ ุฑุณูู ุฅุถุงููุฉ ุนูู ุงูููุงุทู ุงูุจุนูุฏุฉ.
ูุชุญูู ุงูุนููู ูุณุคูููุฉ ุชููุฑู ูุงุณุชูุงู ุงูุทูุจ ูู ุงูููุนุฏ ุงููุญุฏุฏ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "WideRoute",
        "shop_specialization": "ุดุญู ุฏุงุฎูู"
    },
    {
        "policy_text": """
ูู ุญุงู ุชุนุฐุฑ ุชุณููู ุงูุทูุจ ุจุนุฏ ูุญุงููุชูู ูุชุชุงููุชููุ
ูุชู ุฅุนุงุฏุฉ ุงูุดุญูุฉ ุฅูู ุงููุณุชูุฏุน ูุฅูุบุงุก ุงูุทูุจ ุชููุงุฆููุง.
ูุชู ุฎุตู ุฑุณูู ุงูุดุญู ูู ุงููุจูุบ ุงููุณุชุฑุฏ ุฅู ูุฌุฏ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "HomeTrack",
        "shop_specialization": "ุชูุตูู ููุฒูู"
    },
    {
        "policy_text": """
ูุฌุจ ุนูู ุงูุนููู ูุญุต ุงูุดุญูุฉ ููุฑ ุงูุงุณุชูุงู ูุงูุชุฃูุฏ ูู ุณูุงูุชูุง.
ุฃู ููุงุญุธุงุช ูุชู ุชูุฏูููุง ุจุนุฏ 24 ุณุงุนุฉ ูู ุงูุงุณุชูุงู ูุง ุชููู ูุดูููุฉ ุจุงูุชุนููุถ.
ูุฑุฌู ุงูุชูุงุตู ูุน ุฎุฏูุฉ ุงูุนููุงุก ูู ุญุงู ูุฌูุฏ ูุดููุฉ.
""",
        "policy_type": "ุณูุงุณุฉ ุงูุดุญู ู ุงูุชูุตูู",
        "shop_name": "SecureDrop",
        "shop_specialization": "ุชูุตูู ุขูู"
    }
]


# ุฏุงูุฉ ูุฅุฑุณุงู ุงูุทูุจ ุงููุงุญุฏ
async def send_request(session, payload, index):
    print(f"๐ Sending request #{index}")
    try:
        async with session.post(API_URL, json=payload, timeout=15) as response:
            status = response.status
            # ูุฑุงุกุฉ ุงูุฑุฏ ูู JSON
            try:
                result = await response.json()
                print(f"โ Response #{index} [Status: {status}]: {json.dumps(result, ensure_ascii=False, indent=2)}")
            except:
                text = await response.text()
                print(f"โ๏ธ Response #{index} [Status: {status}] (Raw): {text}")
    except Exception as e:
        print(f"โ Request #{index} failed: {e}")

async def main():
    # ุงุณุชุฎุฏุงู ClientSession ูุงุญุฏ ููู ุงูุทูุจุงุช ูุฒูุงุฏุฉ ุงูููุงุกุฉ
    async with aiohttp.ClientSession() as session:
        tasks = []
        
        for i, payload in enumerate(dummy_requests, start=1):
            # ุฅูุดุงุก Task ููู ุฑููููุณุช ุนุดุงู ูุดุชุบู ูู ุงูุฎูููุฉ
            task = asyncio.create_task(send_request(session, payload, i))
            tasks.append(task)
            
            # ุงููุงุตู ุงูุฒููู ุงููู ุทูุจุชู (10 ูููู ุซุงููุฉ = 0.01 ุซุงููุฉ)
            await asyncio.sleep(0.01)
        
        # ุงูุงูุชุธุงุฑ ูุญุฏ ูุง ูู ุงูุทูุจุงุช ุชุฎูุต ูุจู ูุง ูููู ุงูุจุฑูุงูุฌ
        await asyncio.gather(*tasks)

if __name__ == "__main__":
    start_time = time.perf_counter()
    
    # ุชุดุบูู ุงููุญุฑู ุงูุฎุงุต ุจู Async
    asyncio.run(main())
    
    end_time = time.perf_counter()
    print(f"\nโจ All requests finished in {end_time - start_time:.2f} seconds.")
